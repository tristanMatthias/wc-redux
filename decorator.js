var __awaiter=this&&this.__awaiter||function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b||[])).next())})};export default((a,b,c)=>(d)=>class extends d{constructor(){super(),this._eventDispatchMap={},this._bindEventsToDispatch()}_bindEventsToDispatch(){for(const[a,b]of Object.entries(this._eventDispatchMap))this.removeEventListener(a,b);if(this._eventDispatchMap={},this.mapDispatchToEvents)for(const[b,c]of Object.entries(this.mapDispatchToEvents))this._eventDispatchMap[b]=(d)=>__awaiter(this,void 0,void 0,function*(){d.stopImmediatePropagation();let e=d.detail instanceof Array?c(...d.detail):c(d.detail);const f=yield e(a.dispatch);(this.shadowRoot||this).dispatchEvent(new CustomEvent(`${b}-done`,{bubbles:!0,detail:f}))}),this.addEventListener(b,this._eventDispatchMap[b]);if(this._mapStateToProps){const b=this.setProperties?(a)=>this.setProperties(a):(a)=>Object.assign(this,a),c=()=>b(this._mapStateToProps(a.getState()));a.subscribe(c),c()}}_mapStateToProps(a){return b(a)}get mapDispatchToEvents(){return c}});
